{
  "version": 3,
  "sources": ["../../../app/routes/demo.chatbackup.jsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app\\\\\\\\routes\\\\\\\\demo.chatbackup.jsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app\\\\routes\\\\demo.chatbackup.jsx\");\n  import.meta.hot.lastModified = \"1708448308172.7625\";\n}\n// REMIX HMR END\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { UserCircleIcon, ChatBubbleOvalLeftEllipsisIcon, PaperAirplaneIcon, ArrowUpTrayIcon, AdjustmentsVerticalIcon } from \"@heroicons/react/20/solid\";\nfunction formatText(text) {\n  const formattedText = text.replace(/\\*([^\\*]+)\\*/g, \"<strong>$1</strong>\") // Bold: *text*\n  .replace(/_([^_]+)_/g, \"<em>$1</em>\") // Italics: _text_\n  .replace(/- ([^\\n]+)/g, \"<li>$1</li>\"); // Bullets: - item\n\n  return formattedText.split(\"\\n\").map((item, index) => {\n    if (item.startsWith(\"<li>\")) {\n      return <ul key={index}>\r\n          <li>{item.substring(4, item.length - 5)}</li>\r\n        </ul>;\n    } else {\n      return <p key={index} dangerouslySetInnerHTML={{\n        __html: item\n      }} />;\n    }\n  });\n}\nfunction handleChatGPTStream(prompt, onData) {\n  const eventSource = new EventSource(`/demo/gpt?prompt=${encodeURIComponent(prompt)}`);\n  eventSource.onmessage = event => {\n    const data = JSON.parse(event.data);\n    if (data.type === \"done\") {\n      eventSource.close();\n    } else {\n      let content = data?.choices?.[0]?.delta?.content;\n      if (content) {\n        onData(content);\n      }\n    }\n  };\n  eventSource.onerror = event => {\n    console.error(\"EventSource failed:\", event);\n    eventSource.close();\n  };\n}\nexport default function Demo({\n  aiMessage\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const endOfMessagesRef = useRef(null);\n  const textareaRef = useRef(null);\n  const appendToLastMessage = newText => {\n    setMessages(prevMessages => {\n      const lastMessage = prevMessages[prevMessages.length - 1];\n      if (lastMessage && lastMessage.role === \"gpt\") {\n        return [...prevMessages.slice(0, -1), {\n          ...lastMessage,\n          content: lastMessage.content + newText\n        }];\n      } else {\n        return [...prevMessages, {\n          role: \"gpt\",\n          content: newText\n        }];\n      }\n    });\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    const formData = new FormData(e.target);\n    const prompt = formData.get(\"prompt\");\n    setMessages(prevMessages => [...prevMessages, {\n      role: \"user\",\n      content: prompt\n    }]);\n    textareaRef.current.value = \"\";\n    handleChatGPTStream(prompt, appendToLastMessage, () => {\n      setIsSubmitting(false);\n      console.log(\"Streaming complete\");\n    });\n  };\n  useEffect(() => {\n    endOfMessagesRef.current?.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n  return <div className=\"flex h-screen flex-col items-center p-4\">\r\n      <div className=\"w-full max-w-7xl flex-grow overflow-auto\">\r\n        {messages.map((msg, index) => msg.role === \"user\" ? <div key={index} className=\"h-15 my-2 flex self-end rounded-lg border bg-blue-500 p-4 text-gray-200\">\r\n              <div className=\"mr-2 flex flex-shrink-0 flex-col items-start\">\r\n                <ChatBubbleOvalLeftEllipsisIcon className=\"h-6 w-6 text-rose-500\" />\r\n              </div>\r\n              {formatText(msg.content)} \r\n            </div> : <div key={index} className=\"my-2 flex self-end rounded-lg border bg-blue-500/50 p-4 text-gray-200\">\r\n              <div className=\"mr-2 flex flex-shrink-0 flex-col items-start\">\r\n                <UserCircleIcon className=\"h-6 w-6 text-gray-500\" />\r\n              </div>\r\n              {formatText(msg.content)}\r\n            </div>)}\r\n        <div ref={endOfMessagesRef} />\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit} className=\"flex w-full max-w-4xl\">\r\n        <div className=\"flex-grow rounded-md border border-gray-300 p-2 \">\r\n          <textarea required name=\"prompt\" id=\"prompt\" ref={textareaRef} className=\"text-lg\" style={{\n          resize: \"none\"\n        }} />\r\n          <button type=\"submit\" disabled={isSubmitting} className={`ml-2  rounded-md p-2 text-white ${isSubmitting ? \"opacity-50\" : \"\"}`}>\r\n            <PaperAirplaneIcon className=\"h-5 w-5 text-gray-500\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div>\r\n          <button type=\"submit\" disabled={isSubmitting} className={`m-1 flex items-center justify-center rounded-md bg-blue-500 p-2 ${isSubmitting ? \"opacity-50\" : \"\"}`}>\r\n            <ArrowUpTrayIcon className=\"h-5 w-5 text-gray-100\" />\r\n          </button>\r\n          <button type=\"submit\" disabled={isSubmitting} className={`m-1 flex items-center justify-center rounded-md bg-blue-500 p-2 ${isSubmitting ? \"opacity-50\" : \"\"}`}>\r\n            <AdjustmentsVerticalIcon className=\"h-5 w-5 text-gray-100\" />\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>;\n}\n_s(Demo, \"ZdcUgKLlM+1V4EeE6xWV37AO2dc=\");\n_c = Demo;\nvar _c;\n$RefreshReg$(_c, \"Demo\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": []
}
